"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2573],{22573:function(e,t,a){a.d(t,{Z:function(){return q}});var r,i,n=a(5452),l=a(46330),s=a(7323),o=a(87656),d=a(1654),u=a(53705),c=a(91506),g=a(18825),h=a(49660),v=a(62938),m=a(71006),p=a(82490),f=a(27940),y=a(59325),x=a(64312);let P=e=>["feed",null==e?void 0:e.variant,null==e?void 0:e.timeRange,null==e?void 0:e.taskTypeFilters,null==e?void 0:e.operationFilters,null==e?void 0:e.presetId];var w=a(30697),R=a(23651),T=a(47993),H=a(4048),F=a(15767),S=a(34118);(r=i||(i={})).UserQuery="userQuery",r.GenerationQuery="generationQuery",r.Home="home",r.Images="images",r.Videos="videos",r.Top="top",r.Featured="featured",r.Recent="recent",r.Library="library",r.Activity="activity";let M=()=>{let{searchType:e}=(0,S.v)(!1),t=(0,l.usePathname)();return e===F.n8.User?"userQuery":e===F.n8.Generation?"generationQuery":t.startsWith((0,H._e)())?"images":t.startsWith((0,H.gm)())?"videos":t.startsWith((0,H.BL)())?"top":t.startsWith((0,H.hT)())?"featured":t.startsWith((0,H.dw)())?"recent":t.startsWith((0,H.rS)())?"home":t.startsWith((0,H.sp)())?"library":t.startsWith((0,H.OV)())?"activity":null};var b=a(87357),j=a(39826),Q=a(96887),_=a(12776),W=a(86171),Z=a(66980);let k=_.zB.day;function U(){var e;let t=(0,Z.Z)(),a=(0,l.useSearchParams)(),r=null!==(e=a.get("t"))&&void 0!==e?e:void 0,i=Object.values(_.zB),s=i.includes(r)?r:k,d=(0,o.Z)(),u=Object.fromEntries(i.map(e=>[e,d.formatMessage(X["".concat(e,"TimeRange")])]));return(0,n.jsx)("div",{className:"flex",children:(0,n.jsxs)(W.Ph,{onValueChange:e=>{if(e){let r=new URLSearchParams(a);r.set("t",e),t.push("".concat(window.location.pathname,"?").concat(r.toString()))}},value:s,children:[(0,n.jsxs)(j.xz,{className:"flex items-center gap-1.5 text-token-text-secondary",children:[(0,n.jsx)(W.ki,{children:u[s]}),(0,n.jsx)(j.JO,{asChild:!0,children:(0,n.jsx)(Q.Z,{className:"h-4 w-4"})})]}),(0,n.jsx)(W.Bw,{children:Object.values(_.zB).map(e=>(0,n.jsx)(W.Ql,{value:e,children:u[e]},e))})]})})}let X=(0,d.vU)({hourTimeRange:{id:"topFeedTimeRangeSelect.hourTimeRange",description:"Hour time range option",defaultMessage:"Hour"},dayTimeRange:{id:"topFeedTimeRangeSelect.dayTimeRange",description:"Day time range option",defaultMessage:"Day"},weekTimeRange:{id:"topFeedTimeRangeSelect.weekTimeRange",description:"Week time range option",defaultMessage:"Week"},monthTimeRange:{id:"topFeedTimeRangeSelect.monthTimeRange",description:"Month time range option",defaultMessage:"Month"},yearTimeRange:{id:"topFeedTimeRangeSelect.yearTimeRange",description:"Year time range option",defaultMessage:"Year"},all_timeTimeRange:{id:"topFeedTimeRangeSelect.all_timeTimeRange",description:"'All time' time range option",defaultMessage:"All time"}});function q(e){let{variant:t}=e;(0,T.f)("feed",{variant:t});let a=M(),r=(0,l.useSearchParams)(),i=(0,o.Z)(),d=h.Z.useActions(),u=i.formatMessage(function(e){switch(e){case x.X.featured:return I.featuredHeader;case x.X.home:return I.exploreHeader;case x.X.images:return I.imagesHeader;case x.X.videos:return I.videosHeader;case x.X.top:return I.topHeader;case x.X.recent:return I.recentHeader;case x.X.preset:return I.exploreHeader;default:return(0,w.R)(e),I.recentHeader}}(t));return(0,s.useEffect)(()=>{let e="".concat(window.location.pathname).concat(window.location.search);return e.startsWith("/explore")&&d.setRootPage({title:u,href:e}),()=>{}},[d,u,a,r]),(0,n.jsx)(N,{variant:t,title:u})}function N(e){var t,a,r,i,o,d,h,w,T,H;let{variant:F,title:S}=e,M=(0,R.cn)(),j=(0,R.Ke)(),Q=(0,l.useSearchParams)(),[_,W]=(0,s.useState)(Q);(0,s.useEffect)(()=>{window.location.pathname.startsWith("/explore")&&W(Q)},[Q]);let Z=null!==(t=_.get("t"))&&void 0!==t?t:void 0,k=_.get("source"),X=_.get("q"),q=_.get("pid"),N=null!==(a=M||j?k:null)&&void 0!==a?a:null,I=null!==(r=M?X:void 0)&&void 0!==r?r:void 0,G=null!==(i=M?_.getAll("t"):void 0)&&void 0!==i?i:void 0,O=null!==(o=M?_.getAll("c"):void 0)&&void 0!==o?o:void 0,A=null!==(d=M?"true"===_.get("is_showable"):void 0)&&void 0!==d?d:void 0,C=null!==(h=M?"true"===_.get("is_hidden_from_feed"):void 0)&&void 0!==h?h:void 0,{taskTypeFilters:E}=(0,g.Fp)(),{operationFilters:B}=(0,g.eg)(),K=j&&null!==(w=_.get("curator"))&&void 0!==w?w:void 0,{status:L,data:V,error:z,isFetchingNextPage:D,fetchNextPage:J,hasNextPage:Y}=(T={variant:F,timeRange:null!=Z?Z:void 0,taskTypeFilters:E,operationFilters:B,presetId:null!=q?q:void 0},H=null!=N?{adminSource:N,q:I,t:G,c:O,isShowable:A,isHiddenFromFeed:C,curator:K}:void 0,(0,f.useInfiniteQuery)({queryKey:P(T),queryFn:async e=>{if((null==T?void 0:T.variant)===x.X.preset&&(null==T?void 0:T.presetId)){let t=await y.Z.searchPreset(T.presetId,e.pageParam||null);return{...t,data:t.data.map(e=>e.generation)}}return(null==H?void 0:H.adminSource)==="favorites"||(null==H?void 0:H.adminSource)==="recent"||(null==H?void 0:H.adminSource)==="best"||(null==H?void 0:H.adminSource)==="featured"?await y.Z.adminGetFeed({source:null==H?void 0:H.adminSource,after:e.pageParam,q:null==H?void 0:H.q,t:null==H?void 0:H.t,c:null==H?void 0:H.c,isShowable:null==H?void 0:H.isShowable,isHiddenFromFeed:null==H?void 0:H.isHiddenFromFeed,curator:null==H?void 0:H.curator}):await y.Z.getFeed({variant:null==T?void 0:T.variant,after:e.pageParam,time_range:null==T?void 0:T.timeRange,taskTypeFilters:null==T?void 0:T.taskTypeFilters,operationFilters:null==T?void 0:T.operationFilters})},refetchOnMount:!1,initialPageParam:"",getNextPageParam:e=>(null==e?void 0:e.has_more)?e.last_id:null})),$=(0,s.useMemo)(()=>V?V.pages.flatMap(e=>{var t;return null!==(t=null==e?void 0:e.data)&&void 0!==t?t:[]}).filter((e,t,a)=>t===a.findIndex(t=>t.id===e.id)):[],[V]);return(0,u.X)({allGenerations:$,hasNextPage:Y,isFetchingNextPage:D,fetchNextPage:J}),(0,n.jsxs)(b.Z,{title:S,subtitle:F===x.X.top&&(0,n.jsx)(U,{}),children:[F===x.X.preset&&q&&(0,n.jsx)(p.a,{children:(0,n.jsx)(m.J,{presetId:q,actions:[m.R.Manage,m.R.Use]})}),(0,n.jsx)(c.Z,{generations:$,fetchNextPage:J,hasNextPage:Y,isFetchingNextPage:D,status:L,error:z,emptyPlaceholder:E.length>0||B.length>0?(0,n.jsx)(v.Fm,{}):null})]})}let I=(0,d.vU)({featuredHeader:{id:"feed.featuredHeader",description:"Page header for the featured feed page",defaultMessage:"Featured"},recentHeader:{id:"feed.recentHeader",description:"Page header for the recent feed page",defaultMessage:"Recent"},topHeader:{id:"feed.topHeader",description:"Page header for the top feed page",defaultMessage:"Top"},exploreHeader:{id:"feed.exploreHeader",description:"Page header for the explore feed page",defaultMessage:"Explore"},imagesHeader:{id:"feed.imagesHeader",description:"Page header for the images feed page",defaultMessage:"Images"},videosHeader:{id:"feed.videosHeader",description:"Page header for the videos feed page",defaultMessage:"Videos"},presetHeader:{id:"feed.presetHeader",description:"Page header for the preset feed page",defaultMessage:"Preset"}})},15767:function(e,t,a){a.d(t,{KG:function(){return c},n8:function(){return i},nC:function(){return g}});var r,i,n=a(79362),l=a(27940),s=a(59325),o=a(53048);(r=i||(i={})).User="user",r.Generation="generation",r.Text="text";let d=["search","generations"],u=(e,t)=>[...d,{query:e,scope:t}],c=(e,t)=>{let a=("disabled-auth-fake-user-id"===e||e.startsWith("user-"))&&"public"===t,r=e.startsWith("gen_")&&"public"===t;return a?"user":r?"generation":"text"};function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"library",a=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=(0,n.useQueryClient)(),d=null!=r?r:c(e,t);return(0,l.useInfiniteQuery)({queryKey:u(e,t),queryFn:async a=>"user"===d?await s.Z.searchUser(e,a.pageParam||null):"generation"===d?await s.Z.searchGenerations(e.split(","),a.pageParam||null):await s.Z.searchText(e,t,a.pageParam||null),refetchOnMount:"always",initialPageParam:"",getNextPageParam:e=>(null==e?void 0:e.has_more)?e.last_id:null,enabled:a,select:e=>({...e,pages:e.pages.map(e=>({...e,data:e.data.map(e=>{var t;return{...e,generation:null!==(t=i.getQueryData((0,o.NX)(e.generation.id)))&&void 0!==t?t:e.generation}})}))})})}},34118:function(e,t,a){a.d(t,{v:function(){return o}});var r=a(46330),i=a(49660),n=a(15767);let l=()=>{var e;let t=i.Z.useState(e=>e.rootPage),a=null;return(null==t?void 0:t.href)&&(null==t?void 0:null===(e=t.href)||void 0===e?void 0:e.startsWith("/library"))&&(a=new URL(t.href,window.location.origin).searchParams.get("query")),{searchQuery:a}},s=()=>{var e;let t=i.Z.useState(e=>e.rootPage),a=null,r=null;if((null==t?void 0:t.href)&&(null==t?void 0:null===(e=t.href)||void 0===e?void 0:e.startsWith("/explore"))){let e=new URL(t.href,window.location.origin);a=e.searchParams.get("query"),r=e.searchParams.get("user")}return{searchQuery:a,usernameSearchQuery:r}},o=function(){var e,t;let a=!(arguments.length>0)||void 0===arguments[0]||arguments[0],{searchQuery:i}=l(),{searchQuery:o,usernameSearchQuery:d}=s(),u=(0,r.useSearchParams)(),c=null!==(e=u.get("query"))&&void 0!==e?e:"",g=null!==(t=u.get("user"))&&void 0!==t?t:"",h=a?c||i||o||"":c,v=a?g||d||"":g,m=h.trim().length>0,p=v.trim().length>0,f=p?n.n8.User:m?(0,n.KG)(h,"public"):null,y=m&&f===n.n8.Text,x=p||m&&f===n.n8.User,P=m&&f===n.n8.Generation;return{searchQuery:v||h,isQuery:p||m,searchType:f,isValidQuery:y||x||P}}}}]);
//# sourceMappingURL=2573-2792227aee437751.js.map